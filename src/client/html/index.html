<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <title>White Board</title>

    <link href="style/main_.css" type="text/css" rel="stylesheet" />
    <script src="lib/jquery-1.7.2.js"></script>
    <script src="lib/jquery.masonry.min.js"></script>
    <script type="text/javascript" src="lib/jquery.mousewheel-3.0.6.pack.js"></script>
    <script type="text/javascript" src="source/jquery.fancybox.js?v=2.0.6"></script>
    <link rel="stylesheet" type="text/css" href="source/jquery.fancybox.css?v=2.0.6" media="screen" />
    <link rel="stylesheet" type="text/css" href="source/helpers/jquery.fancybox-buttons.css?v=1.0.2" />
    <script type="text/javascript" src="source/helpers/jquery.fancybox-buttons.js?v=1.0.2"></script>
    <link rel="stylesheet" type="text/css" href="source/helpers/jquery.fancybox-thumbs.css?v=1.0.2" />
    <script type="text/javascript" src="source/helpers/jquery.fancybox-thumbs.js?v=1.0.2"></script>
    <script type="text/javascript" src="source/helpers/jquery.fancybox-media.js?v=1.0.0"></script>


    <script type="text/javascript">
        $(document).ready(function() {

            $('.fancybox').fancybox();

        });


        $(function(){
            $('#container').masonry({
                // options
                itemSelector : '.item',
                isAnimated: true,
                animationOptions: {
                    duration: 400,
                    easing: 'linear',
                    queue: false
                },
                columnWidth : 240
            });
        });

        $('#container').masonry({
            // options...
        });

    </script>
    <style type="text/css">
        .fancybox-custom .fancybox-skin {
            box-shadow: 0 0 50px #222;
        }
    </style>

</head>

<body>

<div class="banner"></div>

<div class="leftNav">
    <ul id="categoriesList">
    </ul>
</div>
<div class="rightContent">
    <div class="dailyHeader">Today</div>
    <div id="todayTaskContainer">
        <a class="fancybox fancybox.iframe" href="TestTaskModel.html"><div class="item high addblock">Add New Note</div></a>

    </div>


</div>

<script type="text/javascript" src="../../../src/client/html/lib/json2.js"></script>
<script type="text/javascript" src="../../../src/client/html/js/utils/Utils.js"></script>

<script type="text/javascript" src="../../../src/client/html/js/model/CategoryModel.js"></script>
<script type="text/javascript" src="../../../src/client/html/js/model/TaskModel.js"></script>

<script type="text/javascript">

    function appendCategory(categoryId, name, colorHexCode) {
        var categoryElt = "<li id='{0}' style='background:#{1}'>{2}</li>".format(categoryId, colorHexCode,  name);
        $("#categoriesList").append(categoryElt);
        $("#"+categoryId).click(function(){
            var categoryId = $(this).attr("id");
            $("#categoriesList li").removeClass("categorySelected");
            $(this).addClass("categorySelected");
            populateTasks(categoryId);
        });
    }

    function renderSelectedCategory() {
        var categoryId = $(".categorySelected").attr("id");
        populateTasks(categoryId);
    }

    function renderCategories() {
        var categories = TaskBoard.CategoryModel.list();
        var index = 0;
        var categoryElt;

        appendCategory(0, "All", 'FFFFFF');
        for(index=0; index < categories.length; index++) {
            appendCategory(categories[index].categoryId, categories[index].name, categories[index].colorHexCode);
        }


    }

    function getTaskDivSize(priority) {
        var divSize = 'mid';
        if (priority == TaskBoard.TaskModel.LOW_PRIORITY) {
            divSize = 'low';
        } else if (priority == TaskBoard.TaskModel.HIGH_PRIORITY) {
            divSize = 'high';
        }
        return divSize;
    }

    function populateTasks(categoryId) {
        var index, tasksForToday, task, taskDiv, category;


        $("#todayTaskContainer .task").remove();

        tasksForToday = TaskBoard.TaskModel.todaysTasks(categoryId);

        for(index=0; index<tasksForToday.length; index++) {
            task = tasksForToday[index];
            //taskDiv = "<div id='{0}' class='item {1} task'>{2}</div>".format(task.id, getTaskDivSize(task.priority),task.title);

            category = TaskBoard.CategoryModel.get(task.categoryId);
            taskDiv = ("<div id='{0}' class='item task' style='background:#{1}'>" +
                            "<br/><p class='{2}' > {3}</p>" +
                            "<div class='secondOptions'>" +
                                "<a id='completeTask_{4}' class='Botton menuButtons' href='#' >Complete</a>" +
                                "<a id='deleteTask_{5}' class='Botton menuButtons' href='#' >Delete</a>" +
                            "</div>" +
                      "</div>").format(task.taskId, category.colorHexCode, getTaskDivSize(task.priority), task.title, task.taskId, task.taskId );

//                    <div class="item home" onmouseover="showmenu(this);" onmouseout="hidemenu(this);">
//                    <p class="high">Deposite my gym check</p>
//            <div class="secondOptions annie">
//                    <a class="Botton menuButtons" href="#" onclick="alert('Done');">Done</a>
//                    <a class="Botton menuButtons" href="#" onclick="alert('Delete');">Delete</a>
//                    </div>
//                    <div class="item_info">
//                    <img src="img/_per1.jpg" width="50" height="50" />
//                    <div class="details">
//                    <ul>
//                    <li>Annie Zhao</li>
//                    <li>2 mins ago</li>
//                    </ul>
//                    </div>
//            <div class="focusStar">Focus</div>
//                    </div>
//                    </div>
            
            
            $('#todayTaskContainer').append(taskDiv);

            $("#"+task.taskId).mouseover(function() {
                var taskId = $(this).attr("id");
                $('#'+taskId + ' div').css("display", "block");
            });

            $("#"+task.taskId).mouseout(function() {
                var taskId = $(this).attr("id");
                $('#'+taskId + ' div').css("display", "none");

            });

            $("#completeTask_"+task.taskId).click(function() {
                var taskId = $(this).attr("id").substring("completeTask_".length);
                TaskBoard.TaskModel.complete(taskId);
                renderSelectedCategory();
                return false;

            });

            $("#deleteTask_"+task.taskId).click(function() {
                var taskId = $(this).attr("id").substring("deleteTask_".length);
                TaskBoard.TaskModel.delete(taskId);
                renderSelectedCategory();
                return false;

            });
        }



    }

    $(document).ready(function() {
        $('.fancybox').fancybox();
        // Create home and work category
        createStandardCategories();
        renderCategories();
        populateTasks(0);
    });
</script>


</body>



</body>
</html>
